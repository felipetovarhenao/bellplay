"use strict";(self.webpackChunkbellplay_docs=self.webpackChunkbellplay_docs||[]).push([[7061],{28453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>l});var r=i(96540);const t={},s=r.createContext(t);function a(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(s.Provider,{value:n},e.children)}},86078:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>m,frontMatter:()=>a,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"learning/tutorials/importingmidi","title":"22. Importing MIDI","description":"bellplay~ supports importing MIDI files (.mid or .midi) into our scripts, each described as a list of events.","source":"@site/docs/learning/tutorials/importingmidi.md","sourceDirName":"learning/tutorials","slug":"/learning/tutorials/importingmidi","permalink":"/docs/learning/tutorials/importingmidi","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"ezsampler","permalink":"/docs/tags/ezsampler"},{"inline":true,"label":"fade","permalink":"/docs/tags/fade"},{"inline":true,"label":"freeverb","permalink":"/docs/tags/freeverb"},{"inline":true,"label":"getkey","permalink":"/docs/tags/getkey"},{"inline":true,"label":"importmidi","permalink":"/docs/tags/importmidi"},{"inline":true,"label":"left","permalink":"/docs/tags/left"},{"inline":true,"label":"normalize","permalink":"/docs/tags/normalize"},{"inline":true,"label":"rand","permalink":"/docs/tags/rand"},{"inline":true,"label":"render","permalink":"/docs/tags/render"},{"inline":true,"label":"reverse","permalink":"/docs/tags/reverse"},{"inline":true,"label":"transcribe","permalink":"/docs/tags/transcribe"}],"version":"current","sidebarPosition":21,"frontMatter":{"sidebar_position":21,"title":"22. Importing MIDI","tags":["ezsampler","fade","freeverb","getkey","importmidi","left","normalize","rand","render","reverse","transcribe"]},"sidebar":"tutorialSidebar","previous":{"title":"21. Basic Sampling","permalink":"/docs/learning/tutorials/sampling"},"next":{"title":"23. Feature-driven Sampling","permalink":"/docs/learning/tutorials/kdtree"}}');var t=i(74848),s=i(28453);const a={sidebar_position:21,title:"22. Importing MIDI",tags:["ezsampler","fade","freeverb","getkey","importmidi","left","normalize","rand","render","reverse","transcribe"]},l="Importing MIDI",o={},d=[];function c(e){const n={code:"code",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"importing-midi",children:"Importing MIDI"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"bellplay~"})," supports importing MIDI files (",(0,t.jsx)(n.code,{children:".mid"})," or ",(0,t.jsx)(n.code,{children:".midi"}),") into our scripts, each described as a list of events.\nSimilar to ",(0,t.jsx)(n.strong,{children:"bellplay~"})," buffers, each MIDI event consists of a set of keys with relevant information about each event, including:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"'pitch'"}),": pitch value in midicents."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"'duration'"}),": duration value in milliseconds."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"'velocity'"}),": velocity value, in the range of 0 to 127."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"'voice'"}),": voice number, as an integer."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"'channel'"}),": MIDI channel, as an integer."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"The code belows imports a MIDI file to render it as audio using a very basic guitar sampler."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bell",metastring:'title="importing_midi.bell" showLineNumbers',children:"## import MIDI file as a list of events\n$events = importmidi('satie.mid');\n## set maximum number of midi events (or comment out the line below this one to process midi file)\n$maxevents = 100;\n## get first n events, based on $maxevents\n$events = left($events, $maxevents);\n## iterate through MIDI events and create a buffer for each\nfor $event in $events do (\n    ## retrieve pitch, duration, onset, and velocity information of current event\n    $pitch = $event.getkey('pitch');\n    $dur = $event.getkey('duration');\n    $onset = $event.getkey('onset');\n    $vel = $event.getkey('velocity');\n    ## we divide velocity by 127 to normalize it to a 0-1 range and use it as linear gain\n    $gain = $vel / 127.;\n    ## generate a buffer with note info using **bellplay~** built-in sampler\n    ezsampler(\n        @pitch $pitch\n        @duration $dur\n        @velocity $vel\n    ).transcribe(\n        ## add a slight random onset deviation to \"humanize\" output\n        @onset $onset + rand(-10, 10) \n        @gain $gain\n        @pan rand() rand() \n    ) \n);\n## trigger rendering\nrender(\n    @play 1\n    ## apply post-render processing\n    @process (\n        ## apply reverse reverb\n        reverse() freeverb(\n            @roomsize .9\n            @wet .1\n            @tail 0\n        ) reverse() \n        ## normalize and apply 10 ms fade in\n        normalize(-12) fade(10, 0) \n    ) \n)\n"})})]})}function m(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}}}]);